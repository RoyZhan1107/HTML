<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>按下連結即可下載範例</title>
<style>
  body{font-family:system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans TC", Arial; padding:24px; background:#f6f8fa; color:#0b1220}
  .card{background:white;padding:18px;border-radius:10px;box-shadow:0 6px 20px rgba(2,6,23,0.06);max-width:780px}
  h1{margin:0 0 6px}
  p.lead{margin:0 0 18px;color:#516076}
  a.btn{display:inline-block;padding:8px 12px;border-radius:8px;background:#0ea5e9;color:white;text-decoration:none;margin:6px 6px 6px 0}
  code{background:#eef3fb;padding:2px 6px;border-radius:6px}
</style>
</head>
<body>
  <div class="card">
    <h1>按下連結即可下載 — 範例</h1>
    <p class="lead">把你要分享的檔案放在同一個資料夾，並用以下方式產生下載連結。</p>

    <h3>1) 直接連到本機檔案（同資料夾）</h3>
    <p>
      假設同資料夾有 <code>sample.pdf</code> 與 <code>report.zip</code>，使用 HTML 的 <code>download</code> 屬性可建議瀏覽器下載並指定檔名：
    </p>
    <a class="btn" href="sample.pdf" download>下載 sample.pdf</a>
    <a class="btn" href="report.zip" download="my-report.zip">下載（另存為 my-report.zip）</a>
    <p class="lead" style="margin-top:10px">說明：如果連結指向不同網域 (cross-origin)，有些瀏覽器會忽略 <code>download</code> 屬性。</p>

    <hr>

    <h3>2) 連到外部網址（跨域注意）</h3>
    <p>外部檔案（例如 <code>https://example.com/file.mp3</code>）通常會在瀏覽器開啟預覽，若想強制下載需由該遠端伺服器回傳 <code>Content-Disposition: attachment</code>。</p>
    <a class="btn" href="https://example.com/file.mp3">外部檔案（可能會在新分頁打開）</a>

    <hr>

    <h3>3) 用 JavaScript 動態產生並下載檔案（適合文字檔或小檔）</h3>
    <p>範例：把文字內容產生為檔案並觸發下載</p>
    <button class="btn" id="generateTxt">產生並下載 text.txt</button>
    <button class="btn" id="generateCsv">產生並下載 report.csv</button>

    <hr>

    <h3>4) 伺服器端強制下載（PHP 範例）</h3>
    <p>如果你有伺服器（支援 PHP），放一個檔案下載程式會更可靠，因為可以設定 header 強制瀏覽器下載：</p>
    <pre style="background:#f3f6fb;padding:10px;border-radius:8px">
// save as download.php
<?php
$file = '/var/www/html/files/bigfile.zip'; // 檔案實際路徑
if (!file_exists($file)) { http_response_code(404); exit('Not found'); }
header('Content-Description: File Transfer');
header('Content-Type: application/octet-stream');
header('Content-Disposition: attachment; filename="'.basename($file).'"');
header('Content-Length: ' . filesize($file));
readfile($file);
exit;
?></pre>
    <p>開啟 <code>https://yourserver/download.php</code> 就會強制下載。</p>

    <hr>

    <div id="log" style="margin-top:12px;color:#334155"></div>
  </div>

<script>
document.getElementById('generateTxt').addEventListener('click', ()=>{
  const text = '這是動態產生的檔案內容\\n第二行文字';
  const blob = new Blob([text], {type: 'text/plain'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'text.txt';
  document.body.appendChild(a);
  a.click();
  a.remove();
  setTimeout(()=>URL.revokeObjectURL(url), 2000);
  document.getElementById('log').textContent = '已產生 text.txt 並觸發下載';
});

document.getElementById('generateCsv').addEventListener('click', ()=>{
  const csv = 'name,score\\nAlice,90\\nBob,85';
  const blob = new Blob([csv], {type: 'text/csv'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'report.csv';
  document.body.appendChild(a);
  a.click();
  a.remove();
  setTimeout(()=>URL.revokeObjectURL(url),2000);
  document.getElementById('log').textContent = '已產生 report.csv 並觸發下載';
});
</script>
</body>
</html>
