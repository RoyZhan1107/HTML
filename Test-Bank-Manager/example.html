<!doctype html>
<html lang="zh-Hant">
    <head>
      <meta charset="utf-8" />
      <meta name="viewport" content="width=device-width,initial-scale=1" />
      <link rel="stylesheet" href="example.css">
      <title>題庫管理器</title>
    </head>
    <body>
      <header>
        <span>題庫管理器</span>
      <div class="small">純前端：支援單選/複選/填充/聽力/閱讀/簡答，圖片選填，匯出 Word(.doc) 與 Excel(.xlsx)</div>
      </header>
    <main class="wrap">
      <!-- 左側：題庫列表與操作 -->
      <aside class="panel">
        <div class="left-side">
          <strong>我的題庫</strong>
        <div class="right-top">
          <button id="newBankBtn" class="btn">＋新增題庫</button>
      </div>
    </div>
    <div id="banksList" style="margin-top:10px" class="banks"></div>
    <div class="controls">
      <input id="bankName" type="text" placeholder="新題庫名稱">
      <button id="createBank" class="btn">建立</button>
    </div>

    <hr style="margin:12px 0;border:none;border-top:1px solid #f0f4fb">
    <div class="small muted">匯入/匯出整個題庫集</div>
    <div style="display:flex;gap:8px;margin-top:8px">
      <button id="exportAll" class="btn ghost">⬇ 匯出全部 (JSON)</button>
      <button id="importAll" class="btn ghost">⬆ 匯入</button>
      <input id="importAllFile" type="file" accept="application/json" style="display:none">
    </div>
  </aside>
  <!-- 右側：編輯題庫、上傳題目、測試 -->
  <section class="panel">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <div>
        <strong id="currentBankTitle">未選擇題庫</strong>
        <div class="small muted" id="bankMeta">0 題</div>
      </div>
      <div style="display:flex;gap:8px;align-items:center">
        <button id="exportBank" class="btn ghost">匯出此題庫 (Word)</button>
        <button id="exportExcel" class="btn ghost">匯出 Excel</button>
        <button id="deleteBank" class="btn ghost">刪除題庫</button>
      </div>
    </div>
    <div style="margin-top:12px">
      <div class="grid-two">
        <div>
          <div class="label">新增題目</div>
          <div>
            <label class="small">題型</label>
            <select id="qType" class="question-type">
              <option value="single">單選題 (Single Choice)</option>
              <option value="multiple">複選題 (Multiple Choice)</option>
              <option value="fill">填充題 (Fill in the blank)</option>
              <option value="listening">聽力題 (Listening)</option>
              <option value="reading">閱讀題 (Reading)</option>
              <option value="short">簡答題 (Short answer)</option>
            </select>
          </div>
          <div style="margin-top:8px">
            <label class="small">題幹 / 提示 (必填)</label>
            <textarea id="qPrompt" placeholder="題幹或題目文字：閱讀題可放段落，聽力題可附音檔"></textarea>
          </div>
          <div id="choicesArea" style="margin-top:8px">
            <div class="small">選項 (僅單/複選題顯示)</div>
            <div class="choice-list" id="choiceList"></div>
            <div style="margin-top:6px">
              <button id="addChoice" class="btn ghost">＋ 新增選項</button>
            </div>
            <div class="small muted" style="margin-top:6px">在選項輸入框內使用 `|` 分隔，左側為選項文字，右側可用 `correct` 標記為正解，例如：<br><code>Apple|correct</code></div>
          </div>
          <div style="margin-top:8px">
            <label class="small">填充題（空格位置用 ___）</label>
            <input id="qFillAnswer" type="text" placeholder="填充題正確答案或多個用逗號分隔">
          </div>
          <div style="margin-top:8px">
            <label class="small">附加檔案（圖片 / 音檔，選填）</label>
            <input id="qFile" type="file" accept="image/*,audio/*">
            <div id="filePreview" style="margin-top:8px"></div>
          </div>
          <div style="margin-top:10px;display:flex;gap:8px">
            <button id="addQuestion" class="btn">加入題庫</button>
            <button id="clearForm" class="btn ghost">清除表單</button>
          </div>
        </div>
        <div>
          <div class="quiz-preview" id="previewArea">題目預覽</div>
          <div style="margin-top:8px;display:flex;gap:8px;flex-wrap:wrap">
            <button id="startQuiz" class="btn">▶ 預覽測驗</button>
            <button id="prevQ" class="btn ghost">⬅</button>
            <button id="nextQ" class="btn ghost">➡</button>
            <button id="playAudio" class="btn ghost">🔊 播放音檔</button>
          </div>
        </div>
      </div>
      <hr style="margin:12px 0;border:none;border-top:1px solid #f0f4fb">
      <div>
        <strong>題庫預覽 / 編輯</strong>
        <div id="questionsList" style="margin-top:8px"></div>
      </div>
    </div>
  </section>
</main>

<footer>本工具為純前端示範，資料儲存在 localStorage；Word 匯出為 .doc (HTML 內嵌圖片)，Excel 使用 SheetJS 產生 .xlsx</footer>
</body>
<script src="example.js"></script>
 <!-- SheetJS for Excel export -->
  <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
</html>